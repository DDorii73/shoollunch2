<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>학생 활동 - 급식 관리</title>
  <link rel="stylesheet" href="/src/style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="student-container">
    <header class="student-header">
      <h1>🍽️ 오늘의 급식</h1>
      <button id="back-btn" class="back-btn">← 돌아가기</button>
    </header>

    <!-- 챗봇 섹션 -->
    <div id="chatbot-section" class="chatbot-section">
      <div class="chatbot-container">
        <div class="chatbot-header">
          <h2>급식 챗봇과 대화하기</h2>
          <p class="chatbot-subtitle">오늘의 급식에 대해 이야기해보세요! (3~7회 대화)</p>
        </div>
        <div id="chat-messages" class="chat-messages"></div>
        <div class="chat-input-container">
          <input type="text" id="chat-input" placeholder="메시지를 입력하세요..." />
          <button id="send-btn" class="send-btn">전송</button>
        </div>
        <div class="chatbot-controls">
          <button id="end-chat-btn" class="end-chat-btn hidden">Chatbot과의 대화 끝내기</button>
        </div>
      </div>
    </div>

    <!-- 음식 기록 섹션 -->
    <div id="record-section" class="record-section hidden">
      <div class="record-container">
        <h2>오늘 먹은 음식 기록하기</h2>
        
        <!-- 점심 급식 섹션 -->
        <div class="meal-record">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <h3 style="margin: 0;">🍱 점심 급식</h3>
            <button id="new-lunch-btn" class="new-input-btn hidden" title="새로입력하기">✏️</button>
          </div>
          <p class="meal-description">오늘 제공된 메뉴 중 먹은 것을 클릭하거나 선택하고 횟수를 입력하세요.</p>
          
          <div id="lunch-menu-list" class="menu-list"></div>
          
          <!-- 섭취량 막대그래프 -->
          <div class="consumption-chart-container" style="margin: 20px 0;">
            <h4 style="margin-bottom: 10px; color: var(--text-color);">📊 음식별 섭취량</h4>
            <p style="font-size: 12px; color: var(--text-light); margin-bottom: 15px;">
              골고루 1인분씩 드시는 것을 권장합니다 💚
            </p>
            <canvas id="consumption-chart"></canvas>
          </div>
          
          <div class="calorie-summary">
            <h4>총 칼로리: <span id="lunch-total-calories">0</span> kcal</h4>
            <p id="calorie-detail" style="font-size: 14px; margin-top: 8px; color: var(--text-light); display: none;"></p>
          </div>
          
          <button id="submit-lunch-btn" class="submit-btn lunch-submit">점심 제출하기</button>
        </div>

        <!-- 간식 섹션 -->
        <div class="meal-record">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <h3 style="margin: 0;">🍪 방과후 간식</h3>
            <button id="new-snack-btn" class="new-input-btn hidden" title="새로입력하기">✏️</button>
          </div>
          <p class="meal-description">먹은 간식을 입력하세요.</p>
          
          <div class="snack-input-section">
            <div class="food-input-group">
              <input type="text" id="snack-input" placeholder="간식 이름을 입력하세요 (예: 우유, 빵, 과자)" />
              <button id="add-snack-btn" class="add-btn">추가</button>
              <button id="camera-snack-btn" class="camera-btn" title="사진으로 간식 입력">📷</button>
            </div>
            <input type="file" id="snack-image-input" accept="image/*" capture="environment" style="display: none;" />
            <div class="food-list" id="snack-foods"></div>
            <div id="snack-image-preview" style="display: none; margin-top: 10px;">
              <img id="snack-preview-img" style="max-width: 200px; max-height: 200px; border-radius: 8px;" />
              <div style="margin-top: 10px;">
                <button id="analyze-snack-btn" class="analyze-btn">AI 분석하기</button>
                <button id="cancel-snack-image-btn" class="cancel-btn" style="margin-left: 10px;">취소</button>
              </div>
              <div id="snack-analysis-result" style="margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 8px; display: none;"></div>
            </div>
          </div>
          
          <button id="submit-snack-btn" class="submit-btn snack-submit">간식 제출하기</button>
        </div>
      </div>
    </div>

    <!-- 영양 브리핑 챗봇 섹션 -->
    <div id="nutrition-chatbot-section" class="chatbot-section hidden">
      <div class="chatbot-container">
        <div class="chatbot-header">
          <h2>💊 영양 브리핑 챗봇</h2>
          <p class="chatbot-subtitle">오늘 먹은 음식의 영양 분석과 건강 조언을 받아보세요!</p>
        </div>
        <div id="nutrition-chat-messages" class="chat-messages"></div>
        <div class="chat-input-container">
          <input type="text" id="nutrition-chat-input" placeholder="궁금한 것을 물어보세요..." />
          <button id="nutrition-send-btn" class="send-btn">전송</button>
        </div>
        <div class="chatbot-controls">
          <button id="close-nutrition-btn" class="end-chat-btn">브리핑 완료하기</button>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="/src/main.js"></script>
</body>
</html>
